(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e523145"],{"086d":function(e,t,r){"use strict";var n=r("e272"),a=r.n(n);a.a},"397e":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.verifyPermission(e.$route.name,0)?r("div",{staticClass:"main-box"},[r("XPanel",[r("div",{staticClass:"panel-header",attrs:{slot:"header-right"},slot:"header-right"},[e.verifyPermission(e.$route.name,1)?r("div",{staticClass:"action-btn",on:{click:function(t){return t.stopPropagation(),e.handleAction("add")}}},[r("Tooltip",{attrs:{placement:"top",content:e.$t("L00122")}},[r("Icon",{staticClass:"action-icon",attrs:{type:"md-add"}})],1)],1):e._e(),r("div",{staticClass:"action-btn",on:{click:function(t){return t.stopPropagation(),e.handleAction("refresh")}}},[r("Tooltip",{attrs:{placement:"top",content:e.$t("L00121")}},[r("Icon",{staticClass:"action-icon",attrs:{type:"md-refresh"}})],1)],1)]),r("div",{staticClass:"panel-body",attrs:{slot:"body"},slot:"body"},[r("SearchRoles")],1)]),e.verifyPermission(e.$route.name,1)?r("EditRole"):e._e(),r("DetailRole")],1):e._e()},a=[],o=r("cebc"),s=r("2f62"),i={},c=(r("96cf"),r("3b8d")),l=r("2b0e"),u=l["default"].prototype.$X,p={getRoleList:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.get("/Roles/list",{params:t});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),getAllResourceList:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.get("/Resources/list/all",{params:t});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),doAddRole:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.post("/Roles/add",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),doRemoveRole:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.post("/Roles/remove",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),doEditRole:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.post("/Roles/edit",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},d={list:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.getRoleList(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),"resource/list/all":function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.getAllResourceList(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),add:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.doAddRole(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),edit:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.doEditRole(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),remove:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.doRemoveRole(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}()},m={},f={moduleName:"Roles",store:{namespaced:!0,state:i,actions:d,mutations:m}},h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{title:"edit"===e.currentAction?"编辑":"add"===e.currentAction?"新增":"","mask-closable":!0,closable:!0,width:900},on:{"on-cancel":e.handleCancel},model:{value:e.isShowModal,callback:function(t){e.isShowModal=t},expression:"isShowModal"}},[r("Form",{ref:"modalForm",attrs:{model:e.modalForm,rules:e.formRules,"label-width":120}},[r("FormItem",{attrs:{label:e.$t("L00056"),prop:"name"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00067")},model:{value:e.modalForm.name,callback:function(t){e.$set(e.modalForm,"name",t)},expression:"modalForm.name"}})],1),r("FormItem",{attrs:{label:e.$t("L00070"),prop:"description"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00071"),type:"textarea",rows:4},model:{value:e.modalForm.description,callback:function(t){e.$set(e.modalForm,"description",t)},expression:"modalForm.description"}})],1),r("FormItem",{attrs:{label:e.$t("L00037"),prop:"status"}},[r("Radio-group",{model:{value:e.modalForm.status,callback:function(t){e.$set(e.modalForm,"status",t)},expression:"modalForm.status"}},[r("Radio",{attrs:{label:0}},[e._v(e._s(e.$t("L00106")))]),r("Radio",{attrs:{label:1}},[e._v(e._s(e.$t("L00105")))])],1)],1),r("FormItem",{attrs:{label:e.$t("L00066")}},[r("ElTable",{staticClass:"table-card",attrs:{data:e.rowList,"span-method":e.handleSpan,border:""}},[r("ElTableColumn",{attrs:{prop:"title",label:e.$t("L00072")},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.parent_id?r("span",[r("div",{staticClass:"circle",style:{"background-color":e.handleResourceTypeTag(t.row,"color")}},[e._v(e._s(t.row.id))]),e._v("\n              "+e._s(t.row.lang?e.$t(t.row.lang):t.row.title)+"\n            ")]):r("span",[r("div",{staticClass:"circle",style:{"background-color":e.handleResourceTypeTag(t.row.parent,"color")}},[e._v(e._s(t.row.parent.id))]),e._v("\n              "+e._s(t.row.parent.lang?e.$t(t.row.parent.lang):t.row.parent.title)+"\n            ")])]}}])}),r("ElTableColumn",{attrs:{prop:"second",label:e.$t("L00073")},scopedSlots:e._u([{key:"default",fn:function(t){return[0!=t.row.parent_id?r("span",[r("div",{staticClass:"circle",style:{"background-color":e.handleResourceTypeTag(t.row,"color")}},[e._v(e._s(t.row.id))]),e._v("\n              "+e._s(t.row.lang?e.$t(t.row.lang):t.row.title)+"\n            ")]):e._e()]}}])}),r("ElTableColumn",{attrs:{prop:"type",label:e.$t("L00030")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("Tag",{attrs:{color:e.handleResourceTypeTag(t.row,"color")}},[e._v(e._s(e.$t(e.handleResourceTypeTag(t.row,"lang"))))])]}}])}),r("ElTableColumn",{attrs:{prop:"permission",label:e.$t("L00077")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("CheckboxGroup",{on:{"on-change":function(r){return e.handlePermissionChange(r,t.$index)}},model:{value:t.row.permission,callback:function(r){e.$set(t.row,"permission",r)},expression:"scope.row.permission"}},e._l(e.$X.config.permissionTypeList.filter(function(e){return e.enable&&t.row.permission_type.includes(e.key)}),function(t,n){return r("Checkbox",{key:n,attrs:{label:t.key}},[e._v("\n                "+e._s(t.lang?e.$t(t.lang):t.label)+"\n              ")])}),1)]}}])})],1)],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary",loading:e.doSaveLoading},on:{click:e.doSave}},[e._v(e._s(e.$t("L00109")))]),r("Button",{on:{click:e.doReset}},[e._v(e._s(e.$t("L00111")))])],1)],1)},b=[],v=(r("7f7f"),r("7514"),r("01c8")),g=r("e814"),w=r.n(g),y=(r("28a5"),r("f499")),$=r.n(y),_=(r("2fdb"),r("75fc")),k=(r("6762"),{name:"EditRole",data:function(){return{isShowModal:!1,currentAction:"",defModalForm:{name:"",description:"",status:1,resource_id:"",permission:""},modalForm:{},doSaveLoading:!1,backModalInfo:{},resourceList:[],spanCount:[],rowList:[]}},computed:Object(o["a"])({},Object(s["c"])("Platform",{userInfo:function(e){return e.userInfo}}),{formRules:function(){var e=this;return{name:[{required:!0,message:e.$t("L00067"),trigger:"blur"}],description:[{message:e.$t("L00071"),trigger:"blur"}],resource_id:[{required:!0,type:"array",min:1,message:e.$t("L00078"),trigger:"change"}]}}}),methods:{doSave:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,r,n,a,s,i,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this,t.$refs["modalForm"].validate(function(e){r=e}),void 0===r||r){e.next=5;break}return t.$Message.error(t.$t("L00136")),e.abrupt("return");case 5:if(n=[],a=[],t.rowList.map(function(e){if(e.permission.length){e.parent_id&&(a.includes(e.parent_id)||(a.push(e.parent_id),n.push([e.parent_id,0].join("|"))));var t=[e.id].concat(Object(_["a"])(e.permission));a.push(e.id),n.push(t.join("|"))}}),i=Object(o["a"])({},t.modalForm,{resource_id:a.join(","),permission:n.join(",")}),"add"===t.currentAction?s="Apps/Roles/add":"edit"===t.currentAction&&(s="Apps/Roles/edit"),s){e.next=12;break}return e.abrupt("return");case 12:return t.doSaveLoading=!0,e.next=15,t.$store.dispatch(s,i);case 15:if(c=e.sent,t.doSaveLoading=!1,c&&200===c.code){e.next=19;break}return e.abrupt("return");case 19:t.$Message.success(c.msg),t.handleCancel(),t.$X.utils.bus.$emit("Apps/Roles/list/refresh");case 22:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),doReset:function(){var e=this;e.initFormData()},initFormData:function(){var e=this;e.currentAction=e.backModalInfo&&e.backModalInfo.action?e.backModalInfo.action:e.currentAction;var t=JSON.parse($()(e.defModalForm));if("edit"===e.currentAction&&e.backModalInfo&&e.backModalInfo.info){var r=e.backModalInfo.info instanceof Object?JSON.parse($()(e.backModalInfo.info)):e.backModalInfo.info;e.modalForm=Object(o["a"])({},t,r)}else e.modalForm=Object(o["a"])({},t);e.handleResourceTree()},handleCancel:function(){var e=this;e.initFormData(),e.isShowModal=!1},getResourceList:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,t.$store.dispatch("Apps/Roles/resource/list/all",{enable:[0,1],type:["module-system","module-app","module-link"]});case 3:if(r=e.sent,r&&200===r.code){e.next=6;break}return e.abrupt("return");case 6:r.data.count&&r.data.list&&r.data.list.length?t.$Message.success(r.msg):t.$Message.info(t.$t("L00011")),t.resourceList=r.data.list||[];case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleResourceTree:function(){var e=this,t=e.userInfo.currentUserGroup||e.userInfo.user_groups[0]||{},r=t.resource_id?t.resource_id.split(","):[];r=r.map(function(e){return w()(e)});var n=function(t){return t.filter(function(t){return(0!==e.userInfo.type&&r.includes(t.id)||0===e.userInfo.type)&&t.enable&&["module-system","module-app","module-link"].includes(t.type)})},a=n(e.resourceList),s=[],i=e.modalForm.permission.split(",").map(function(e){var t=e.split("|").map(function(e){return w()(e)}),r=Object(v["a"])(t),n=r[0],a=r.slice(1);return{id:n,permission:a}});a.map(function(e,t){if(0===e.parent_id){var r,n=0;if(a.map(function(t){if(t.parent_id===e.id){void 0===r&&(r=s.length);var a=i.find(function(e){return e.id===t.id});s.push(Object(o["a"])({},t,{level:2,count:0,permission:a?a.permission:[],parent:e})),n++}}),n)void 0!==r&&(s[r]["count"]=n);else{var c=i.find(function(t){return t.id===e.id});s.push(Object(o["a"])({},e,{level:1,count:1,permission:c?c.permission:[]}))}}}),e.rowList=s},handleSpan:function(e){var t=e.row,r=(e.column,e.rowIndex,e.columnIndex);return 0===r?{rowspan:t.count,colspan:1}:{rowspan:1,colspan:1}},handleResourceTypeTag:function(e,t){var r=this,n=r.$X.config.resourceTypeList.find(function(t){return t.name===e.type});return n?n[t]:""},handlePermissionChange:function(e,t){var r=this;r.rowList[t].permission.includes(1)&&!r.rowList[t].permission.includes(0)&&(r.rowList[t].permission=[0,1])}},created:function(){var e=this;e.$X.utils.bus.$on("Apps/Roles/edit",function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.isShowModal=!0,e.backModalInfo=r,t.next=4,e.getResourceList();case 4:e.initFormData();case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},beforeDestroy:function(){var e=this;e.$X.utils.bus.$off("Apps/Roles/edit")}}),R=k,L=(r("086d"),r("2877")),x=Object(L["a"])(R,h,b,!1,null,"61e4cd28",null),I=x.exports,S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-panel"},[r("Form",{staticClass:"search-form",attrs:{inline:"",model:e.searchForm},nativeOn:{submit:function(e){e.preventDefault()}}},[r("FormItem",[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t(e.filterTypeLabel[e.searchForm.filterType].placeholder)},on:{"on-enter":function(t){return t.stopPropagation(),t.preventDefault(),e.doSearch(t)}},model:{value:e.searchForm.keywords,callback:function(t){e.$set(e.searchForm,"keywords",t)},expression:"searchForm.keywords"}},[r("Select",{staticStyle:{width:"120px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.searchForm.filterType,callback:function(t){e.$set(e.searchForm,"filterType",t)},expression:"searchForm.filterType"}},e._l(e.filterTypeLabel,function(t,n){return r("Option",{key:n,attrs:{value:n}},[e._v("\n          "+e._s(t.lang?e.$t(t.lang):t.label)+"\n        ")])}),1)],1)],1),r("FormItem",[r("CheckboxGroup",{model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[r("Checkbox",{attrs:{label:1}},[r("span",[e._v(e._s(e.$t("L00105")))])]),r("Checkbox",{attrs:{label:0}},[r("span",[e._v(e._s(e.$t("L00106")))])])],1)],1),r("FormItem",[r("Button",{attrs:{type:"primary"},on:{click:e.doSearch}},[e._v(e._s(e.$t("L00120")))])],1)],1),r("div",{staticClass:"clear"}),e.tableData.length?r("Table",{staticClass:"search-form-table",attrs:{data:e.tableData,columns:e.tableColumns}}):e._e(),e.pageInfo.total?r("Page",{staticClass:"search-form-page",attrs:{total:e.pageInfo.total,current:e.pageInfo.currentPage,"page-size":e.pageInfo.pageSize,placement:"top","show-sizer":"","show-elevator":"","show-total":""},on:{"on-change":e.pageChange,"on-page-size-change":e.pageSizeChange}}):e._e()],1)},T=[],C={name:"SearchRoles",data:function(){return{filterTypeLabel:{title:{label:"用户组",lang:"L00056",placeholder:"L00067"},resource_id:{label:"资源ID",lang:"L00068",placeholder:"L00069"}},searchForm:{keywords:"",filterType:"title",status:[]},tableColumns:[],tableData:[],pageInfo:{currentPage:1,total:0,pageSize:10}}},computed:Object(o["a"])({},Object(s["b"])("Platform",["userInfo","userClass","verifyPermission"]),{columnsMap:function(){var e=this;return{field:[{type:"index",width:60,align:"center"},{title:"ID",key:"id"},{title:e.$t("L00056"),key:"name"},{title:e.$t("L00066"),key:"resource_id",render:function(e,t){var r=t.row.resource_id.split(","),n="-";return r.length&&(n=r.length),e("span",n)}},{title:e.$t("L00128"),key:"status",render:function(t,r){return t("XSwitch",{props:{size:"large",callbackParams:r.index,beforeToggle:e.switchStatus,value:!!r.row.status,disabled:!e.verifyPermission(e.$route.name,1)}},[t("span",{slot:"open"},e.$t("L00105")),t("span",{slot:"close"},e.$t("L00106"))])}}],time:[{title:e.$t("L00043"),key:"create_time",render:function(t,r){return t("span",e.$X.moment(r.row["create_time"]).format("YYYY-MM-DD hh:mm:ss"))}},{title:e.$t("L00044"),key:"update_time",render:function(t,r){return t("span",e.$X.moment(r.row["update_time"]).format("YYYY-MM-DD hh:mm:ss"))}},{title:e.$t("L00120"),key:"action",width:170,render:function(t,r){var n=[],a=[t("Button",{props:{size:"small"},style:{margin:"2px"},on:{click:function(){e.handleAction("detail",r.row)}}},e.$t("L00017"))],o=[t("Button",{props:{type:"primary",size:"small"},style:{margin:"2px"},on:{click:function(){e.handleAction("edit",r.row)}}},e.$t("L00123")),t("Button",{props:{type:"error",size:"small"},style:{margin:"2px"},on:{click:function(){e.handleAction("remove",r.row)}}},e.$t("L00124"))];return n=e.verifyPermission(e.$route.name,1)?[].concat(a,o):[].concat(a),t("div",n)}}],createUser:[{title:e.$t("L00057"),key:"create_user_id",render:function(e,t){var r=t.row.create_user||{},n=t.row.create_user_id||"-";return r.name&&r.account&&(n=r.name+" "+r.account),e("span",n)}}]}}}),methods:{doSearch:function(e){var t=this;return t.initList(),!1},initList:function(e){var t=this;t.pageInfo={currentPage:1,total:0,pageSize:10},e&&(t.searchForm={keywords:"",filterType:"title",status:[]}),t.handleTableColumns(),t.getList()},getList:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,t.$store.dispatch("Apps/Roles/list",Object(o["a"])({currentPage:t.pageInfo.currentPage,pageSize:t.pageInfo.pageSize},t.searchForm));case 3:if(r=e.sent,r&&200===r.code){e.next=6;break}return e.abrupt("return");case 6:r.data.count&&r.data.list&&r.data.list.length?t.$Message.success(r.msg):t.$Message.info(t.$t("L00011")),t.tableData=r.data.list||[],t.pageInfo.total=r.data.count||0;case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),switchStatus:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,r){var n,a,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,null===t){e.next=13;break}return a=n.tableData[t],e.next=5,n.$store.dispatch("Apps/Roles/edit",{id:a.id,status:r?0:1});case 5:if(o=e.sent,o&&200===o.code){e.next=9;break}return n.$Message.error(r?n.$t("L00137"):n.$t("L00138")),e.abrupt("return",!0);case 9:return n.$Message.success(r?n.$t("L00139"):n.$t("L00140")),e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}(),pageChange:function(e){var t=this;t.pageInfo.currentPage=e,t.getList()},pageSizeChange:function(e){var t=this;t.pageInfo.pageSize=e,t.getList()},doRemove:function(e){var t=this;e&&t.$Modal.confirm({title:t.$t("L00141"),content:t.$t("L00060"),onOk:function(){var r=Object(c["a"])(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$store.dispatch("Apps/Roles/remove",[e.id]);case 2:if(n=r.sent,n&&200===n.code){r.next=5;break}return r.abrupt("return");case 5:t.$Message.info(n.msg),t.initList();case 7:case"end":return r.stop()}},r)}));function n(){return r.apply(this,arguments)}return n}()})},doEdit:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=this,t){e.next=3;break}return e.abrupt("return");case 3:r.$X.utils.bus.$emit("Apps/Roles/edit",{action:"edit",info:Object(o["a"])({},t)});case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),handleTableColumns:function(){var e=this;e.tableColumns=[].concat(Object(_["a"])(e.columnsMap.field),Object(_["a"])(e.columnsMap.createUser),Object(_["a"])(e.columnsMap.time))},handleDetail:function(e){var t=this;t.$X.utils.bus.$emit("Apps/Roles/detail",{action:"detail",info:e})},handleAction:function(e,t){var r=this;if(e&&t)switch(e){case"detail":r.handleDetail(t);break;case"edit":r.doEdit(t);break;case"remove":r.doRemove(t);break}}},created:function(){var e=this;e.$X.utils.bus.$on("Apps/Roles/list/init",function(){e.initList(!0)}),e.$X.utils.bus.$on("Apps/Roles/list/refresh",function(){e.initList()})},beforeDestroy:function(){var e=this;e.$X.utils.bus.$off("Apps/Roles/list/init"),e.$X.utils.bus.$off("Apps/Roles/list/refresh")}},O=C,F=Object(L["a"])(O,S,T,!1,null,"ceff11d6",null),j=F.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{staticClass:"detail-modal",attrs:{title:"详情","mask-closable":!0,closable:!0,width:900},on:{"on-cancel":e.handleCancel},model:{value:e.isShowModal,callback:function(t){e.isShowModal=t},expression:"isShowModal"}},[r("Form",{staticClass:"detail-form",attrs:{model:e.detailInfo,"label-width":120}},[e._l(Object.keys(e.detailInfo).filter(function(e){return!["_index","_rowKey"].includes(e)}),function(t,n){return["name"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00056"),prop:"name"}},[r("Input",{staticStyle:{width:"400px"},attrs:{readonly:""},model:{value:e.detailInfo.name,callback:function(t){e.$set(e.detailInfo,"name",t)},expression:"detailInfo.name"}})],1):"description"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00070"),prop:"description"}},[r("Input",{staticStyle:{width:"400px"},attrs:{type:"textarea",rows:4,readonly:""},model:{value:e.detailInfo.description,callback:function(t){e.$set(e.detailInfo,"description",t)},expression:"detailInfo.description"}})],1):"status"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00037"),prop:"status"}},[r("Radio-group",{model:{value:e.detailInfo.status,callback:function(t){e.$set(e.detailInfo,"status",t)},expression:"detailInfo.status"}},[0===e.detailInfo.status?r("Radio",{attrs:{label:0}},[e._v(e._s(e.$t("L00106")))]):e._e(),1===e.detailInfo.status?r("Radio",{attrs:{label:1}},[e._v(e._s(e.$t("L00105")))]):e._e()],1)],1):"create_user"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00057"),prop:"url"}},[r("span",[e._v(e._s(e.detailInfo.create_user.name)+" "+e._s(e.detailInfo.create_user.account))])]):"create_time"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00043"),prop:"create_time"}},[r("div",[e._v(e._s(e.$X.moment(e.detailInfo[t]).format("YYYY-MM-DD hh:mm:ss")))])]):"update_time"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00044"),prop:"update_time"}},[r("div",[e._v(e._s(e.$X.moment(e.detailInfo[t]).format("YYYY-MM-DD hh:mm:ss")))])]):"resource_id"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00066")}},[r("ElTable",{staticClass:"table-card",attrs:{data:e.rowList,"span-method":e.handleSpan,border:""}},[r("ElTableColumn",{attrs:{prop:"title",label:e.$t("L00072")},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.parent_id?r("span",[r("div",{staticClass:"circle",style:{"background-color":e.handleResourceTypeTag(t.row,"color")}},[e._v(e._s(t.row.id))]),e._v("\n              "+e._s(t.row.lang?e.$t(t.row.lang):t.row.title)+"\n            ")]):r("span",[r("div",{staticClass:"circle",style:{"background-color":e.handleResourceTypeTag(t.row.parent,"color")}},[e._v(e._s(t.row.parent.id))]),e._v("\n              "+e._s(t.row.parent.lang?e.$t(t.row.parent.lang):t.row.parent.title)+"\n            ")])]}}],null,!0)}),r("ElTableColumn",{attrs:{prop:"second",label:e.$t("L00073")},scopedSlots:e._u([{key:"default",fn:function(t){return[0!=t.row.parent_id?r("span",[r("div",{staticClass:"circle",style:{"background-color":e.handleResourceTypeTag(t.row,"color")}},[e._v(e._s(t.row.id))]),e._v("\n              "+e._s(t.row.lang?e.$t(t.row.lang):t.row.title)+"\n            ")]):e._e()]}}],null,!0)}),r("ElTableColumn",{attrs:{prop:"type",label:e.$t("L00030")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("Tag",{attrs:{color:e.handleResourceTypeTag(t.row,"color")}},[e._v(e._s(e.$t(e.handleResourceTypeTag(t.row,"lang"))))])]}}],null,!0)}),r("ElTableColumn",{attrs:{prop:"permission",label:e.$t("L00077")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.permission.length?r("CheckboxGroup",{staticStyle:{position:"relative"},model:{value:t.row.permission,callback:function(r){e.$set(t.row,"permission",r)},expression:"scope.row.permission"}},[r("div",{staticClass:"mask-disabled",on:{click:function(e){e.stopPropagation(),e.preventDefault()}}}),e._l(e.$X.config.permissionTypeList.filter(function(e){return e.enable&&t.row.permission_type.includes(e.key)&&t.row.permission.includes(e.key)}),function(t,n){return r("Checkbox",{key:n,attrs:{label:t.key}},[e._v("\n                  "+e._s(t.lang?e.$t(t.lang):t.label)+"\n                ")])})],2):r("span",[e._v("-")])]}}],null,!0)})],1)],1):e._e()]})],2),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:e.handleCancel}},[e._v(e._s(e.$t("L00113")))])],1)],1)},A=[],D={name:"DetailRole",data:function(){return{isShowModal:!1,detailInfo:{},resourceList:[],rowList:[]}},computed:Object(o["a"])({},Object(s["c"])("Platform",{userInfo:function(e){return e.userInfo}})),methods:{init:function(e){var t=this;t.detailInfo=e,t.handleResourceTree()},handleCancel:function(){var e=this;e.detailInfo={},e.isShowModal=!1},getResourceList:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,t.$store.dispatch("Apps/Roles/resource/list/all",{enable:[0,1],type:["module-system","module-app","module-link"]});case 3:if(r=e.sent,r&&200===r.code){e.next=6;break}return e.abrupt("return");case 6:r.data.count&&r.data.list&&r.data.list.length?t.$Message.success(r.msg):t.$Message.info(t.$t("L00011")),t.resourceList=r.data.list||[];case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleResourceTree:function(){var e=this,t=e.userInfo.currentUserGroup||e.userInfo.user_groups[0]||{},r=t.resource_id?t.resource_id.split(","):[];r=r.map(function(e){return w()(e)});var n=function(t){return t.filter(function(t){return(0!==e.userInfo.type&&r.includes(t.id)||0===e.userInfo.type)&&t.enable&&["module-system","module-app","module-link"].includes(t.type)})},a=n(e.resourceList),s=[],i=e.detailInfo.permission.split(",").map(function(e){var t=e.split("|").map(function(e){return w()(e)}),r=Object(v["a"])(t),n=r[0],a=r.slice(1);return{id:n,permission:a}});a.map(function(e,t){if(0===e.parent_id){var r,n=0;if(a.map(function(t){if(t.parent_id===e.id){void 0===r&&(r=s.length);var a=i.find(function(e){return e.id===t.id});s.push(Object(o["a"])({},t,{level:2,count:0,permission:a?a.permission:[],parent:e})),n++}}),n)void 0!==r&&(s[r]["count"]=n);else{var c=i.find(function(t){return t.id===e.id});s.push(Object(o["a"])({},e,{level:1,count:1,permission:c?c.permission:[]}))}}}),e.rowList=s},handleSpan:function(e){var t=e.row,r=(e.column,e.rowIndex,e.columnIndex);return 0===r?{rowspan:t.count,colspan:1}:{rowspan:1,colspan:1}},handleResourceTypeTag:function(e,t){var r=this,n=r.$X.config.resourceTypeList.find(function(t){return t.name===e.type});return n?n[t]:""}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this,t.$X.utils.bus.$on("Apps/Roles/detail",function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getResourceList();case 2:t.init(r.info),t.isShowModal=!0;case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),beforeDestroy:function(){var e=this;e.$X.utils.bus.$off("Apps/Roles/detail")}},P=D,X=(r("de10"),Object(L["a"])(P,M,A,!1,null,"03f54300",null)),E=X.exports,Y={name:"Roles",components:{EditRole:I,SearchRoles:j,DetailRole:E},computed:Object(o["a"])({},Object(s["b"])("Platform",["verifyPermission"])),methods:{handleAction:function(e){var t=this;switch(e){case"add":t.$X.utils.bus.$emit("Apps/Roles/edit",{action:"add",info:{}});break;case"refresh":t.$X.utils.bus.$emit("Apps/Roles/list/refresh");break}}},created:function(){var e=this;e.$store.registerModule(["Apps",f.moduleName],f.store),e.$nextTick(function(){e.$X.utils.bus.$emit("Apps/Roles/list/init")})},destroyed:function(){var e=this;e.$store.unregisterModule(["Apps",f.moduleName])}},z=Y,N=Object(L["a"])(z,n,a,!1,null,"fca06e00",null);t["default"]=N.exports},"9e67":function(e,t,r){},a21f:function(e,t,r){var n=r("584a"),a=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},de10:function(e,t,r){"use strict";var n=r("9e67"),a=r.n(n);a.a},e272:function(e,t,r){},f499:function(e,t,r){e.exports=r("a21f")}}]);