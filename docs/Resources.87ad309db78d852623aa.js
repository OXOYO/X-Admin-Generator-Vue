(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Resources"],{"2f21":function(e,t,r){"use strict";var n=r("79e5");e.exports=function(e,t){return!!e&&n(function(){t?e.call(null,function(){},1):e.call(null)})}},"55dd":function(e,t,r){"use strict";var n=r("5ca1"),a=r("d8e8"),o=r("4bf8"),i=r("79e5"),s=[].sort,l=[1,2,3];n(n.P+n.F*(i(function(){l.sort(void 0)})||!i(function(){l.sort(null)})||!r("2f21")(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),a(e))}})},"59e4":function(e,t,r){},a21f:function(e,t,r){var n=r("584a"),a=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},a257:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.verifyPermission(e.$route.name,0)?r("div",{staticClass:"main-box"},[r("XPanel",[r("div",{staticClass:"panel-header",attrs:{slot:"header-right"},slot:"header-right"},[e.verifyPermission(e.$route.name,1)?r("div",{staticClass:"action-btn",on:{click:function(t){return t.stopPropagation(),e.handleAction("add")}}},[r("Tooltip",{attrs:{placement:"top",content:e.$t("L00122")}},[r("Icon",{staticClass:"action-icon",attrs:{type:"md-add"}})],1)],1):e._e(),r("div",{staticClass:"action-btn",on:{click:function(t){return t.stopPropagation(),e.handleAction("refresh")}}},[r("Tooltip",{attrs:{placement:"top",content:e.$t("L00121")}},[r("Icon",{staticClass:"action-icon",attrs:{type:"md-refresh"}})],1)],1),e.verifyPermission(e.$route.name,1)?r("div",{staticClass:"action-btn",on:{click:function(t){return t.stopPropagation(),e.handleAction("sort")}}},[r("Tooltip",{attrs:{placement:"top",content:e.$t("L00130")}},[r("Icon",{staticClass:"action-icon",staticStyle:{transform:"rotate(90deg)"},attrs:{type:"md-swap"}})],1)],1):e._e()]),r("div",{staticClass:"panel-body",attrs:{slot:"body"},slot:"body"},[r("SearchResources")],1)]),e.verifyPermission(e.$route.name,1)?r("EditResource"):e._e(),r("DetailResource"),e.verifyPermission(e.$route.name,1)?r("SortResource"):e._e()],1):e._e()},a=[],o=r("cebc"),i=r("2f62"),s={},l=(r("96cf"),r("3b8d")),c=r("2b0e"),u=c["default"].prototype.$X,p={getResourceList:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.get("/Resources/list",{params:t});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),getAllResourceList:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.get("/Resources/list/all",{params:t});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),doAddResource:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.post("/Resources/add",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),doEditResource:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.post("/Resources/edit",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),doSortResource:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.post("/Resources/sort",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),doRemoveResource:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.http.post("/Resources/remove",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},d={list:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.getResourceList(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),"list/all":function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.getAllResourceList(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),add:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.doAddResource(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),edit:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.doEditResource(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),sort:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.doSortResource(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}(),remove:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,p.doRemoveResource(r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}()},m={},f={moduleName:"Resources",store:{namespaced:!0,state:s,actions:d,mutations:m}},h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{title:e.$t(e.modalTitle[e.currentAction]),"mask-closable":!0,closable:!0,width:900},on:{"on-cancel":e.handleCancel},model:{value:e.isShowModal,callback:function(t){e.isShowModal=t},expression:"isShowModal"}},[r("Form",{ref:"modalForm",attrs:{model:e.modalForm,rules:e.formRules,"label-width":120}},[r("FormItem",{attrs:{label:e.$t("L00018"),prop:"name"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00019")},model:{value:e.modalForm.name,callback:function(t){e.$set(e.modalForm,"name",t)},expression:"modalForm.name"}})],1),r("FormItem",{attrs:{label:e.$t("L00020"),prop:"title"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00021")},model:{value:e.modalForm.title,callback:function(t){e.$set(e.modalForm,"title",t)},expression:"modalForm.title"}})],1),r("FormItem",{attrs:{label:e.$t("L00063"),prop:"lang"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00064")},model:{value:e.modalForm.lang,callback:function(t){e.$set(e.modalForm,"lang",t)},expression:"modalForm.lang"}})],1),r("FormItem",{attrs:{label:e.$t("L00022"),prop:"description"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00023"),type:"textarea",rows:4},model:{value:e.modalForm.description,callback:function(t){e.$set(e.modalForm,"description",t)},expression:"modalForm.description"}})],1),r("FormItem",{attrs:{label:e.$t("L00024"),prop:"icon"}},[r("Input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("L00025"),icon:e.modalForm.icon},model:{value:e.modalForm.icon,callback:function(t){e.$set(e.modalForm,"icon",t)},expression:"modalForm.icon"}})],1),r("FormItem",{attrs:{label:e.$t("L00144"),prop:"dir"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00145")},model:{value:e.modalForm.dir,callback:function(t){e.$set(e.modalForm,"dir",t)},expression:"modalForm.dir"}})],1),r("FormItem",{attrs:{label:e.$t("L00026"),prop:"parent_id"}},[r("InputNumber",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("L00058")},model:{value:e.modalForm.parent_id,callback:function(t){e.$set(e.modalForm,"parent_id",t)},expression:"modalForm.parent_id"}})],1),r("FormItem",{attrs:{label:e.$t("L00028"),prop:"num"}},[r("InputNumber",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("L00061")},model:{value:e.modalForm.num,callback:function(t){e.$set(e.modalForm,"num",t)},expression:"modalForm.num"}})],1),r("FormItem",{attrs:{label:e.$t("L00030"),prop:"type"}},[r("Radio-group",{on:{"on-change":e.handleResourceTypeChange},model:{value:e.modalForm.type,callback:function(t){e.$set(e.modalForm,"type",t)},expression:"modalForm.type"}},e._l(e.$X.config.resourceTypeList.filter(function(e){return e.enable}),function(t){return r("Radio",{key:t.name,attrs:{label:t.name}},[e._v("\n          "+e._s(t.lang?e.$t(t.lang):t.label)+"\n        ")])}),1)],1),r("FormItem",{attrs:{label:e.$t("L00031"),prop:"permission_type"}},[r("CheckboxGroup",{model:{value:e.modalForm.permission_type,callback:function(t){e.$set(e.modalForm,"permission_type",t)},expression:"modalForm.permission_type"}},e._l(e.permissionTypeList,function(t,n){return r("Checkbox",{key:n,attrs:{label:t.key}},[r("span",[e._v(e._s(t.lang?e.$t(t.lang):t.label))])])}),1)],1),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:"module-link"===e.modalForm.type,expression:"modalForm.type === 'module-link'"}],attrs:{label:e.$t("L00032"),prop:"url"}},[r("Input",{attrs:{placeholder:e.$t("L00033")},model:{value:e.modalForm.url,callback:function(t){e.$set(e.modalForm,"url",t)},expression:"modalForm.url"}})],1),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:"module-link"===e.modalForm.type,expression:"modalForm.type === 'module-link'"}],attrs:{label:e.$t("L00034"),prop:"target"}},[r("Radio-group",{model:{value:e.modalForm.target,callback:function(t){e.$set(e.modalForm,"target",t)},expression:"modalForm.target"}},[r("Radio",{attrs:{label:0}},[e._v(e._s(e.$t("L00104")))]),r("Radio",{attrs:{label:1}},[e._v(e._s(e.$t("L00103")))])],1)],1),r("FormItem",{attrs:{label:e.$t("L00037"),prop:"enable"}},[r("Radio-group",{model:{value:e.modalForm.enable,callback:function(t){e.$set(e.modalForm,"enable",t)},expression:"modalForm.enable"}},[r("Radio",{attrs:{label:0}},[e._v(e._s(e.$t("L00106")))]),r("Radio",{attrs:{label:1}},[e._v(e._s(e.$t("L00105")))])],1)],1),r("FormItem",{attrs:{label:e.$t("L00146"),prop:"position"}},[r("CheckboxGroup",{model:{value:e.modalForm.position,callback:function(t){e.$set(e.modalForm,"position",t)},expression:"modalForm.position"}},e._l(e.positionTypeList,function(t,n){return r("Checkbox",{key:n,attrs:{label:t.name}},[r("span",[e._v(e._s(t.lang?e.$t(t.lang):t.label))])])}),1)],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary",loading:e.doSaveLoading},on:{click:e.doSave}},[e._v(e._s(e.$t("L00109")))]),r("Button",{on:{click:e.doReset}},[e._v(e._s(e.$t("L00111")))])],1)],1)},b=[],v=r("f499"),$=r.n(v),y=(r("6762"),r("2fdb"),{name:"EditResource",data:function(){return{isShowModal:!1,currentAction:"",modalTitle:{edit:"L00123",add:"L00122",addChild:"L00062",copyAdd:"L00122"},defModalForm:{title:"",name:"",icon:"",dir:"",parent_id:0,num:0,type:"module-app",url:"",target:0,permission_type:[],enable:1,position:[]},modalForm:{},doSaveLoading:!1,backModalInfo:{}}},computed:Object(o["a"])({},Object(i["c"])("Platform",{userInfo:function(e){return e.userInfo},userClass:function(e){return e.userClass}}),{permissionTypeList:function(){var e=this;return e.$X.config.permissionTypeList.filter(function(t){return t.enable&&t.resourceType.includes(e.modalForm.type)})},positionTypeList:function(){var e=this;return e.$X.config.positionTypeList.filter(function(e){return e.enable})},formRules:function(){var e=this;return{title:[{required:!0,message:e.$t("L00021"),trigger:"blur"}],name:[{required:!0,message:e.$t("L00019"),trigger:"blur"}],parent_id:[{required:!0,type:"number",message:e.$t("L00058"),trigger:"blur"}],permission_type:[{required:!0,type:"array",message:e.$t("L00079")}]}}}),methods:{doSave:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,r,n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this,t.$refs["modalForm"].validate(function(e){r=e}),void 0===r||r){e.next=5;break}return t.$Message.error(t.$t("L00136")),e.abrupt("return");case 5:if(n="",["add","addChild","copyAdd"].includes(t.currentAction)?n="Apps/Resources/add":"edit"===t.currentAction&&(n="Apps/Resources/edit"),n){e.next=9;break}return e.abrupt("return");case 9:return t.doSaveLoading=!0,e.next=12,t.$store.dispatch(n,Object(o["a"])({},t.modalForm,{permission_type:t.modalForm.permission_type.join(","),position:t.modalForm.position.join(",")}));case 12:if(a=e.sent,t.doSaveLoading=!1,a&&200===a.code){e.next=16;break}return e.abrupt("return");case 16:t.$Message.success(a.msg),t.handleCancel(),t.$X.utils.bus.$emit("Apps/Resources/list/refresh"),t.$X.utils.bus.$emit("Platform/Admin/refresh");case 20:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),doReset:function(){var e=this;e.initFormData()},initFormData:function(){var e=this;e.currentAction=e.backModalInfo&&e.backModalInfo.action?e.backModalInfo.action:e.currentAction;var t=JSON.parse($()(e.defModalForm));if(["edit","addChild","copyAdd"].includes(e.currentAction)&&e.backModalInfo&&e.backModalInfo.info){var r=e.backModalInfo.info instanceof Object?JSON.parse($()(e.backModalInfo.info)):e.backModalInfo.info;e.modalForm=Object(o["a"])({},t,r)}else e.modalForm=Object(o["a"])({},t)},handleCancel:function(){var e=this;e.initFormData(),e.$refs.modalForm.resetFields(),e.isShowModal=!1},handleResourceTypeChange:function(e){var t=this;t.modalForm.permission_type=[],"module-link"!==e&&(t.modalForm.url=""),"action"===e&&(t.modalForm.sidebar=0)}},created:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this,t.$X.utils.bus.$on("Apps/Resources/edit",function(e){t.isShowModal=!0,e&&e.action&&"addChild"===e.action?t.backModalInfo={action:e.action,info:{parent_id:e.info.id}}:t.backModalInfo=e,t.initFormData()});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),beforeDestroy:function(){var e=this;e.$X.utils.bus.$off("Apps/Resources/edit")}}),g=y,k=r("2877"),w=Object(k["a"])(g,h,b,!1,null,"71a6f0b0",null),x=w.exports,L=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{staticClass:"detail-modal",attrs:{title:e.$t("L00017"),"mask-closable":!0,closable:!0,width:900},on:{"on-cancel":e.handleCancel},model:{value:e.isShowModal,callback:function(t){e.isShowModal=t},expression:"isShowModal"}},[r("Form",{staticClass:"detail-form",attrs:{model:e.detailInfo,"label-width":120}},[e._l(Object.keys(e.detailInfo).filter(function(e){return!["_index","_rowKey"].includes(e)}),function(t,n){return["name"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00018"),prop:"name"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00019"),readonly:""},model:{value:e.detailInfo.name,callback:function(t){e.$set(e.detailInfo,"name",t)},expression:"detailInfo.name"}})],1):"title"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00020"),prop:"title"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00021"),readonly:""},model:{value:e.detailInfo.title,callback:function(t){e.$set(e.detailInfo,"title",t)},expression:"detailInfo.title"}})],1):"description"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00022"),prop:"description"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00023"),type:"textarea",rows:4,readonly:""},model:{value:e.detailInfo.description,callback:function(t){e.$set(e.detailInfo,"description",t)},expression:"detailInfo.description"}})],1):"icon"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00024"),prop:"icon"}},[r("Input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("L00025"),icon:e.detailInfo.icon,readonly:""},model:{value:e.detailInfo.icon,callback:function(t){e.$set(e.detailInfo,"icon",t)},expression:"detailInfo.icon"}})],1):"dir"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00144"),prop:"dir"}},[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("L00145"),readonly:""},model:{value:e.detailInfo.dir,callback:function(t){e.$set(e.detailInfo,"dir",t)},expression:"detailInfo.dir"}})],1):"parent_id"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00026"),prop:"parent_id"}},[r("Input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("L00027"),readonly:""},model:{value:e.detailInfo.parent_id,callback:function(t){e.$set(e.detailInfo,"parent_id",t)},expression:"detailInfo.parent_id"}})],1):"num"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00028"),prop:"num"}},[r("Input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("L00029"),readonly:""},model:{value:e.detailInfo.num,callback:function(t){e.$set(e.detailInfo,"num",t)},expression:"detailInfo.num"}})],1):"type"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00030"),prop:"type"}},[r("Radio-group",{model:{value:e.detailInfo.type,callback:function(t){e.$set(e.detailInfo,"type",t)},expression:"detailInfo.type"}},e._l(e.$X.config.resourceTypeList.filter(function(t){return t.enable&&t.name===e.detailInfo.type}),function(t){return r("Radio",{key:t.name,attrs:{label:t.name}},[e._v("\n            "+e._s(t.lang?e.$t(t.lang):t.label)+"\n          ")])}),1)],1):"permission_type"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00031"),prop:"permission_type"}},[r("CheckboxGroup",{staticStyle:{position:"relative"},model:{value:e.detailInfo.permission_type,callback:function(t){e.$set(e.detailInfo,"permission_type",t)},expression:"detailInfo.permission_type"}},[r("div",{staticClass:"mask-disabled",on:{click:function(e){e.stopPropagation(),e.preventDefault()}}}),e._l(e.permissionTypeList,function(t,n){return r("Checkbox",{key:n,attrs:{label:t.key}},[r("span",[e._v(e._s(t.lang?e.$t(t.lang):t.label))])])})],2)],1):"url"===t?r("FormItem",{directives:[{name:"show",rawName:"v-show",value:"module-link"===e.detailInfo.type,expression:"detailInfo.type === 'module-link'"}],key:t+"_"+n,attrs:{label:e.$t("L00032"),prop:"url"}},[r("Input",{attrs:{placeholder:e.$t("L00033"),readonly:""},model:{value:e.detailInfo.url,callback:function(t){e.$set(e.detailInfo,"url",t)},expression:"detailInfo.url"}})],1):"target"===t?r("FormItem",{directives:[{name:"show",rawName:"v-show",value:"module-link"===e.detailInfo.type,expression:"detailInfo.type === 'module-link'"}],key:t+"_"+n,attrs:{label:e.$t("L00034"),prop:"target"}},[r("Radio-group",{model:{value:e.detailInfo.target,callback:function(t){e.$set(e.detailInfo,"target",t)},expression:"detailInfo.target"}},[0===e.detailInfo.target?r("Radio",{attrs:{label:0}},[e._v(e._s(e.$t("L00104")))]):e._e(),1===e.detailInfo.target?r("Radio",{attrs:{label:1}},[e._v(e._s(e.$t("L00103")))]):e._e()],1)],1):"enable"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00037"),prop:"enable"}},[r("Radio-group",{model:{value:e.detailInfo.enable,callback:function(t){e.$set(e.detailInfo,"enable",t)},expression:"detailInfo.enable"}},[0===e.detailInfo.enable?r("Radio",{attrs:{label:0}},[e._v(e._s(e.$t("L00106")))]):e._e(),1===e.detailInfo.enable?r("Radio",{attrs:{label:1}},[e._v(e._s(e.$t("L00105")))]):e._e()],1)],1):"position"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00146"),prop:"position"}},[r("CheckboxGroup",{model:{value:e.detailInfo.position,callback:function(t){e.$set(e.detailInfo,"position",t)},expression:"detailInfo.position"}},[r("div",{staticClass:"mask-disabled",on:{click:function(e){e.stopPropagation(),e.preventDefault()}}}),e._l(e.positionTypeList,function(t,n){return r("Checkbox",{key:n,attrs:{label:t.name}},[r("span",[e._v(e._s(t.lang?e.$t(t.lang):t.label))])])})],2)],1):"create_time"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00043"),prop:"create_time"}},[r("div",[e._v(e._s(e.$X.moment(e.detailInfo[t]).format("YYYY-MM-DD hh:mm:ss")))])]):"update_time"===t?r("FormItem",{key:t+"_"+n,attrs:{label:e.$t("L00044"),prop:"update_time"}},[r("div",[e._v(e._s(e.$X.moment(e.detailInfo[t]).format("YYYY-MM-DD hh:mm:ss")))])]):r("FormItem",{key:t+"_"+n,attrs:{label:t,prop:t}},[r("div",[e._v(e._s(e.detailInfo[t]))])])]})],2),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:e.handleCancel}},[e._v(e._s(e.$t("L00113")))])],1)],1)},_=[],I={name:"DetailResource",data:function(){return{isShowModal:!1,detailInfo:{}}},computed:Object(o["a"])({},Object(i["c"])("Platform",{userInfo:function(e){return e.userInfo},userClass:function(e){return e.userClass}}),{permissionTypeList:function(){var e=this;return e.$X.config.permissionTypeList.filter(function(t){return t.enable&&t.resourceType.includes(e.detailInfo.type)&&e.detailInfo.permission_type.includes(t.key)})},positionTypeList:function(){var e=this;return e.$X.config.positionTypeList.filter(function(e){return e.enable})}}),methods:{init:function(e){var t=this;t.detailInfo=e},handleCancel:function(){var e=this;e.detailInfo={},e.isShowModal=!1}},mounted:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this,t.$X.utils.bus.$on("Apps/Resources/detail",function(e){t.init(e.info),t.isShowModal=!0});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),beforeDestroy:function(){var e=this;e.$X.utils.bus.$off("Apps/Resources/detail")}},R=I,F=Object(k["a"])(R,L,_,!1,null,"22c35eb6",null),S=F.exports,C=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-panel"},[r("Form",{staticClass:"search-form",attrs:{inline:"",model:e.searchForm},nativeOn:{submit:function(e){e.preventDefault()}}},[r("FormItem",[r("Input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t(e.filterTypeLabel[e.searchForm.filterType].placeholder)},on:{"on-enter":function(t){return t.stopPropagation(),t.preventDefault(),e.doSearch(t)}},model:{value:e.searchForm.keywords,callback:function(t){e.$set(e.searchForm,"keywords",t)},expression:"searchForm.keywords"}},[r("Select",{staticStyle:{width:"120px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.searchForm.filterType,callback:function(t){e.$set(e.searchForm,"filterType",t)},expression:"searchForm.filterType"}},e._l(e.filterTypeLabel,function(t,n){return r("Option",{key:n,attrs:{value:n}},[e._v("\n            "+e._s(t.lang?e.$t(t.lang):t.label)+"\n          ")])}),1)],1)],1),r("FormItem",[r("CheckboxGroup",{model:{value:e.searchForm.enable,callback:function(t){e.$set(e.searchForm,"enable",t)},expression:"searchForm.enable"}},[r("Checkbox",{attrs:{label:1}},[r("span",[e._v(e._s(e.$t("L00105")))])]),r("Checkbox",{attrs:{label:0}},[r("span",[e._v(e._s(e.$t("L00106")))])])],1)],1),r("FormItem",[r("CheckboxGroup",{model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},e._l(e.$X.config.resourceTypeList.filter(function(e){return e.enable}),function(t){return r("Checkbox",{key:t.name,attrs:{label:t.name}},[r("span",[e._v(e._s(t.lang?e.$t(t.lang):t.label))])])}),1)],1),r("FormItem",[r("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:e.$t("L00147")},model:{value:e.searchForm.position,callback:function(t){e.$set(e.searchForm,"position",t)},expression:"searchForm.position"}},e._l(e.positionTypeList,function(t,n){return r("Option",{key:n,attrs:{value:t.name,label:t.lang?e.$t(t.lang):t.label}},[r("span",[e._v(e._s(t.lang?e.$t(t.lang):t.label))])])}),1)],1),r("FormItem",[r("Button",{attrs:{type:"primary"},on:{click:e.doSearch}},[e._v(e._s(e.$t("L00120")))])],1)],1),r("div",{staticClass:"clear"}),e.tableData.length?r("Table",{staticClass:"search-form-table",attrs:{data:e.tableData,columns:e.tableColumns}}):e._e(),e.pageInfo.total?r("Page",{staticClass:"search-form-page",attrs:{total:e.pageInfo.total,current:e.pageInfo.currentPage,"page-size":e.pageInfo.pageSize,placement:"top","show-sizer":"","show-elevator":"","show-total":""},on:{"on-change":e.pageChange,"on-page-size-change":e.pageSizeChange}}):e._e()],1)},A=[],M=r("e265"),O=r.n(M),j=r("a4bb"),T=r.n(j);function X(e,t){if(null==e)return{};var r,n,a={},o=T()(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}function P(e,t){if(null==e)return{};var r,n,a=X(e,t);if(O.a){var o=O()(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var D=r("e814"),z=r.n(D),E=(r("28a5"),r("7f7f"),r("7514"),{name:"SearchResources",data:function(){return{filterTypeLabel:{title:{label:"资源标题",lang:"L00020",placeholder:"L00021"},name:{label:"资源名称",lang:"L00018",placeholder:"L00019"},parent_id:{label:"父ID",lang:"L00026",placeholder:"L00058"}},searchForm:{keywords:"",filterType:"title",enable:[],type:[],position:""},tableData:[],pageInfo:{currentPage:1,total:0,pageSize:10}}},computed:Object(o["a"])({},Object(i["b"])("Platform",["userInfo","userClass","verifyPermission"]),{positionTypeList:function(){var e=this;return e.$X.config.positionTypeList.filter(function(e){return e.enable})},tableColumns:function(){var e=this;return[{type:"index",width:60,align:"center"},{title:"ID",key:"id"},{title:e.$t("L00018"),key:"name"},{title:e.$t("L00020"),key:"title"},{title:e.$t("L00024"),key:"icon",render:function(e,t){var r=t.row.icon;return r?e("Icon",{props:{type:r},style:{fontSize:"20px",marginRight:"10px",verticalAlign:"middle"}}):e("span","-")}},{title:e.$t("L00026"),key:"parent_id",render:function(e,t){var r="-";return null!==t["row"]["parent_id"]&&(r=t["row"]["parent_id"]),e("span",r)}},{title:e.$t("L00028"),key:"num",sortable:!0},{title:e.$t("L00030"),key:"type",render:function(t,r){var n=e.$X.config.resourceTypeList.find(function(e){return e.name===r.row.type});if(n){var a=n.lang?e.$t(n.lang):n.label;return t("Tag",{props:{color:n.color||""}},a)}return t("span","-")}},{title:e.$t("L00034"),key:"target",render:function(t,r){return"module-link"===r.row.type?t("XSwitch",{props:{size:"large",callbackParams:r.index,beforeToggle:e.switchTarget,value:!!r.row.target,disabled:!e.verifyPermission(e.$route.name,1)}},[t("span",{slot:"open"},e.$t("L00103")),t("span",{slot:"close"},e.$t("L00104"))]):t("span","-")}},{title:e.$t("L00128"),key:"enable",render:function(t,r){return t("XSwitch",{props:{size:"large",callbackParams:r.index,beforeToggle:e.switchEnable,value:!!r.row.enable,disabled:!e.verifyPermission(e.$route.name,1)}},[t("span",{slot:"open"},e.$t("L00105")),t("span",{slot:"close"},e.$t("L00106"))])}},{title:e.$t("L00129"),key:"action",width:300,render:function(t,r){var n=[],a=[t("Button",{props:{size:"small"},style:{margin:"2px"},on:{click:function(){e.handleAction("detail",r.row)}}},e.$t("L00017"))],o=[t("Button",{props:{type:"primary",size:"small"},style:{margin:"2px"},on:{click:function(){e.handleAction("edit",r.row)}}},e.$t("L00123")),t("Button",{props:{type:"primary",size:"small"},style:{margin:"2px"},on:{click:function(){e.handleAction("copyAdd",r.row)}}},e.$t("L00133")),t("Button",{props:{type:"warning",size:"small"},style:{margin:"2px"},on:{click:function(){e.handleAction("addChild",r.row)}}},e.$t("L00059")),t("Button",{props:{type:"error",size:"small"},style:{margin:"2px"},on:{click:function(){e.handleAction("remove",r.row)}}},e.$t("L00124"))];return n=e.verifyPermission(e.$route.name,1)?[].concat(a,o):[].concat(a),t("div",n)}}]}}),methods:{doSearch:function(){var e=this;return e.initResourceList(),!1},initResourceList:function(e){var t=this;t.pageInfo={currentPage:1,total:0,pageSize:10},e&&(t.searchForm={keywords:"",filterType:"title",enable:[],type:[],position:""}),t.getResourceList()},getResourceList:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,t.$store.dispatch("Apps/Resources/list",Object(o["a"])({currentPage:t.pageInfo.currentPage,pageSize:t.pageInfo.pageSize},t.searchForm));case 3:if(r=e.sent,r&&200===r.code){e.next=6;break}return e.abrupt("return");case 6:r.data.count&&r.data.list&&r.data.list.length?t.$Message.success(r.msg):t.$Message.info(t.$t("L00011")),n=r.data.list||[],n=n.map(function(e){if(e.permission_type){var t=e.permission_type.split(",");e.permission_type=t.map(function(e){return z()(e)})}else e.permission_type=[];if(e.position){var r=e.position.split(",");e.position=r}else e.position=[];return e}),t.tableData=n,t.pageInfo.total=r.data.count||0;case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),switchTarget:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,r){var n,a,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,null===t){e.next=14;break}return a=n.tableData[t],e.next=5,n.$store.dispatch("Apps/Resources/edit",{id:a.id,target:r?0:1});case 5:if(o=e.sent,o&&200===o.code){e.next=9;break}return n.$Message.error(o.msg),e.abrupt("return",!0);case 9:return n.$Message.success(o.msg),n.$X.utils.bus.$emit("Platform/Admin/refresh"),e.abrupt("return",!1);case 14:return e.abrupt("return",!0);case 15:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}(),switchEnable:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,r){var n,a,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,null===t){e.next=14;break}return a=n.tableData[t],e.next=5,n.$store.dispatch("Apps/Resources/edit",{id:a.id,enable:r?0:1});case 5:if(o=e.sent,o&&200===o.code){e.next=9;break}return n.$Message.error(r?n.$t("L00137"):n.$t("L00138")),e.abrupt("return",!0);case 9:return n.$Message.success(r?n.$t("L00139"):n.$t("L00140")),n.$X.utils.bus.$emit("Platform/Admin/refresh"),e.abrupt("return",!1);case 14:return e.abrupt("return",!0);case 15:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}(),pageChange:function(e){var t=this;t.pageInfo.currentPage=e,t.getResourceList()},pageSizeChange:function(e){var t=this;t.pageInfo.pageSize=e,t.getResourceList()},doRemove:function(e){var t=this;e&&t.$Modal.confirm({title:t.$t("L00141"),content:t.$t("L00060"),onOk:function(){var r=Object(l["a"])(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$store.dispatch("Apps/Resources/remove",[e.id]);case 2:if(n=r.sent,n&&200===n.code){r.next=5;break}return r.abrupt("return");case 5:t.$Message.info(n.msg),t.initResourceList();case 7:case"end":return r.stop()}},r)}));function n(){return r.apply(this,arguments)}return n}()})},doEdit:function(e){var t=this;e&&t.$X.utils.bus.$emit("Apps/Resources/edit",{action:"edit",info:e})},doCopyAdd:function(e){var t=this;if(e){e.id;var r=P(e,["id"]);t.$X.utils.bus.$emit("Apps/Resources/edit",{action:"copyAdd",info:r})}},doAddChild:function(e){var t=this;e&&t.$X.utils.bus.$emit("Apps/Resources/edit",{action:"addChild",info:e})},handleDetail:function(e){var t=this;t.$X.utils.bus.$emit("Apps/Resources/detail",{action:"detail",info:e})},handleAction:function(e,t){var r=this;if(e&&t)switch(e){case"detail":r.handleDetail(t);break;case"edit":r.doEdit(t);break;case"copyAdd":r.doCopyAdd(t);break;case"addChild":r.doAddChild(t);break;case"remove":r.doRemove(t);break}}},created:function(){var e=this;e.$X.utils.bus.$on("Apps/Resources/list/init",function(){e.initResourceList(!0)}),e.$X.utils.bus.$on("Apps/Resources/list/refresh",function(){e.initResourceList()})},beforeDestroy:function(){var e=this;e.$X.utils.bus.$off("Apps/Resources/list/init"),e.$X.utils.bus.$off("Apps/Resources/list/refresh")}}),N=E,B=Object(k["a"])(N,C,A,!1,null,"0d9990e6",null),Y=B.exports,J=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{title:e.$t("L00130"),"mask-closable":!0,closable:!0},on:{"on-cancel":e.handleCancel},model:{value:e.isShowModal,callback:function(t){e.isShowModal=t},expression:"isShowModal"}},[e.menuMap.children&&e.menuMap.children.length?r("div",{staticClass:"sort-list"},e._l(e.menuMap.children,function(t){return r("div",{key:t.name,staticClass:"sort-item"},[r("InputNumber",{staticClass:"item-num",model:{value:t.num,callback:function(r){e.$set(t,"num",r)},expression:"item.num"}}),r("div",{staticClass:"item-title"},[e._v(e._s(t.id)+" "+e._s(t.lang?e.$t(t.lang):t.title))]),t.resources.children&&t.resources.children.length?r("div",{class:{handler:!0,"handler-open":t.expand},on:{click:function(r){return e.handleExpand(t)}}},[r("Icon",{attrs:{type:t.expand?"chevron-down":"chevron-up"}})],1):e._e(),t.resources.children&&t.resources.children.length?r("div",{class:{"sort-children":!0,"sort-children-open":t.expand}},e._l(t.resources.children,function(t){return r("div",{key:t.name,staticClass:"sort-item"},[r("InputNumber",{staticClass:"item-num",model:{value:t.num,callback:function(r){e.$set(t,"num",r)},expression:"childItem.num"}}),r("div",{staticClass:"item-title"},[e._v(e._s(t.id)+" "+e._s(t.lang?e.$t(t.lang):t.title))])],1)}),0):e._e()],1)}),0):e._e(),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary",loading:e.doSaveLoading},on:{click:e.doSave}},[e._v(e._s(e.$t("L00109")))]),r("Button",{on:{click:e.doReset}},[e._v(e._s(e.$t("L00111")))])],1)])},G=[],q=(r("55dd"),{name:"SortResource",data:function(){return{isShowModal:!1,menuList:[],menuMap:{},resourceList:[],doSaveLoading:!1,backModalInfo:{}}},methods:{init:function(){var e=this;e.handleMenuList(),e.isShowModal=!0},handleMenuList:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=this,t){e.next=6;break}return e.next=4,r.getResourceList();case 4:t=e.sent,r.resourceList=t;case 6:n=function e(t,r){var n={parent_id:r,children:[],expand:!1},a=[],i=0;return t.map(function(e){e.parent_id===r?(n.children.push(Object(o["a"])({},e,{index:i})),i+=1):a.push(e)}),n.children.sort(function(e,t){return e.num-t.num}),n.children.length&&a.length&&n.children.map(function(t){t.resources=e(a,t.id)}),n},r.menuMap=n(t,0);case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getResourceList:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,t.$store.dispatch("Apps/Resources/list/all",{enable:[1],type:["module-system","module-app","module-link"]});case 3:if(r=e.sent,r&&200===r.code){e.next=6;break}return e.abrupt("return",[]);case 6:return r.data.count&&r.data.list&&r.data.list.length?t.$Message.success(r.msg):t.$Message.info(t.$t("L00011")),e.abrupt("return",r.data.list||[]);case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleCancel:function(){var e=this;e.isShowModal=!1},handleExpand:function(e){var t=this;t.menuMap.children=t.menuMap.children.map(function(t){return t.name===e.name&&(t.expand=!t.expand),t})},doSave:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,r,n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,r=[],n=function e(t){t.map(function(t){r.push({id:t.id,num:t.num}),t.resources&&t.resources.children&&t.resources.children.length&&e(t.resources.children)})},n(t.menuMap.children),t.doSaveLoading=!0,e.next=7,t.$store.dispatch("Apps/Resources/sort",r);case 7:if(a=e.sent,t.doSaveLoading=!1,a&&200===a.code){e.next=11;break}return e.abrupt("return");case 11:t.$Message.success(a.msg),t.handleCancel(),t.$X.utils.bus.$emit("Apps/Resources/list/refresh"),t.$X.utils.bus.$emit("Platform/Admin/refresh");case 15:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),doReset:function(){}},created:function(){var e=this;e.$X.utils.bus.$on("Apps/Resources/sort",function(){e.init()})},beforeDestroy:function(){var e=this;e.$X.utils.bus.$off("Apps/Resources/sort")}}),K=q,H=(r("ed08"),Object(k["a"])(K,J,G,!1,null,"185cb8fc",null)),Q=H.exports,U={name:"Resources",components:{EditResource:x,DetailResource:S,SearchResources:Y,SortResource:Q},computed:Object(o["a"])({},Object(i["b"])("Platform",["verifyPermission"])),methods:{handleAction:function(e){var t=this;switch(e){case"add":t.$X.utils.bus.$emit("Apps/Resources/edit",{action:"add",info:{}});break;case"refresh":t.$X.utils.bus.$emit("Apps/Resources/list/refresh");break;case"sort":t.$X.utils.bus.$emit("Apps/Resources/sort");break}}},created:function(){var e=this;e.$store.registerModule(["Apps",f.moduleName],f.store),e.$nextTick(function(){e.$X.utils.bus.$emit("Apps/Resources/list/init")})},destroyed:function(){var e=this;e.$store.unregisterModule(["Apps",f.moduleName])}},V=U,W=Object(k["a"])(V,n,a,!1,null,"bdc54afa",null);t["default"]=W.exports},ed08:function(e,t,r){"use strict";var n=r("59e4"),a=r.n(n);a.a},f499:function(e,t,r){e.exports=r("a21f")}}]);